<div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">
        {{ 'Talent.PreviewModal.Headers.TalentCard' | translate }}
    </h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="dismiss('Cross click')"></button>
</div>
<div class="modal-body">
    <div class="container-fluid">
        <div class="row mb-5">
            <div class="col-12">
                <app-job-application-steps [jobApplication]="jobApplication" />
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                @if(isExpressApplication) {
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <h3>
                                        {{ jobApplication?.expressApplication?.lastName }}, {{
                                        jobApplication?.expressApplication?.firstName }}
                                    </h3>
                                    <h5>
                                        <i class="fa-solid fa-envelope me-2"></i>
                                        {{ jobApplication?.expressApplication?.email }}
                                    </h5>
                                    <h5>
                                        <i class="fa-solid fa-phone me-2"></i>
                                        {{ jobApplication?.expressApplication?.phone }}
                                    </h5>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    @if(!showResume) {
                                    <button class="btn btn-primary btn-sm" (click)="onShowResume(jobApplication?.id)">
                                        <i class="fa-solid fa-eye me-2"></i>
                                        {{ 'Talent.PreviewModal.ShowResume' | translate }}
                                    </button>
                                    }
                                    @else {
                                    <button class="btn btn-primary btn-sm" (click)="showResume = false;">
                                        <i class="fa-solid fa-eye-slash me-2"></i>
                                        {{ 'Talent.PreviewModal.HideResume' | translate }}
                                    </button>
                                    }
                                </div>
                                @if (showResume) {
                                <div class="col-md-12 mt-3" *ngIf="resumeUrl">
                                    <iframe [src]="resumeUrl" width="100%" height="800px">
                                    </iframe>
                                </div>
                                }
                            </div>
                        </div>
                    </div>
                } @else if (currentTalent) {
                    <!-- Basic Information -->
                    <div class="row mb-4">
                        <div class="col-md-2 profile-picture-section">
                            <img [src]="profilePicture" class="img-thumbnail mb-2">
                        </div>
                        <div class="col-md-10">
                            <div class="row">
                                <div class="col-md-12">
                                    <h3>
                                        {{ currentTalent.firstName }}, {{ currentTalent.lastName }}
                                    </h3>

                                    @if (currentTalent.profileTitle) {
                                        <h5>
                                            <i class="fa-solid fa-user-tie me-2"></i>
                                            {{ currentTalent.profileTitle }}
                                        </h5>
                                    }

                                    <!-- Email -->
                                    @if(currentTalent.email) {
                                    <h6>
                                        <i class="fa-solid fa-envelope me-2"></i>
                                        {{ currentTalent.email }}
                                    </h6>
                                    }
                                    <!-- Phone -->
                                    @if(currentTalent.phone) {
                                    <h6>
                                        <i class="fa-solid fa-phone me-2"></i>
                                        {{ currentTalent.phone }}
                                    </h6>
                                    }
                                    <h6>
                                        <i class="fa-solid fa-location-dot me-2 opacity-75"></i>
                                        @if(currentTalent.city) {
                                        {{ currentTalent.city || null | geoName | async }},
                                        }
                                        @if (currentTalent.region) {
                                        {{ currentTalent.region || null | geoName | async }},
                                        }
                                        {{ currentTalent.country || '' | countryName }}
                                        @if (!(currentTalent.city && currentTalent.region && currentTalent.country))
                                        {
                                        {{ 'Talent.EditProfile.AddressNotSpecified' | translate }}
                                        }
                                    </h6>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-8">
                                    <p *ngIf="currentTalent.summary">
                                        {{ isSummaryExpanded ? currentTalent.summary : (currentTalent.summary |slice:0:150)
                                        + '...' }}
                                        <a *ngIf="hasLongSummary" class="static-link"
                                            (click)="this.isSummaryExpanded = !this.isSummaryExpanded">
                                            {{ isSummaryExpanded ? 'Less' : 'More' }}
                                        </a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Application & Educations & Experiences & Resumes Tabs -->
                    <div class="row">
                        <nav ngbNav #nav="ngbNav" class="nav-tabs" (activeIdChange)="onTabChange($event)">
                            <ng-container ngbNavItem="application">
                                <a ngbNavLink>
                                    <i class="fa-solid fa-graduation-cap me-2"></i>
                                    Application
                                </a>
                                <ng-template ngbNavContent>
                                    @if (jobApplication) {
                                    
                                    }
                                </ng-template>
                            </ng-container>
                            <ng-container ngbNavItem="experiences">
                                <a ngbNavLink>
                                    <i class="fa-solid fa-graduation-cap me-2"></i>
                                    {{ 'Talent.Profile.Experiences' | translate }}
                                </a>
                                <ng-template ngbNavContent>
                                    @if (currentTalent.educations.length != 0) {
                                    <div *ngFor="let experience of currentTalent.experiences; let isLast = last">
                                        <h5>
                                            {{ experience.jobTitle }} {{ 'Talent.PreviewModal.At' | translate }} {{
                                            experience.companyName }}
                                        </h5>
                                        <div class="mb-2">
                                            <i class="fa-regular fa-clock me-2"></i>
                                            {{ getExperienceDuration(experience) }}
                                        </div>
                                        @if(!isLast) {
                                        <hr>
                                        }
                                    </div>
                                    }
                                    @else {
                                    {{ 'Talent.PreviewModal.NoExperiences' | translate }}
                                    }
                                </ng-template>
                            </ng-container>
                            <ng-container ngbNavItem="educations">
                                <a ngbNavLink>
                                    <i class="fa-solid fa-star me-2"></i>
                                    {{ 'Talent.Profile.Educations' | translate }}
                                </a>
                                <ng-template ngbNavContent>
                                    @if (currentTalent.educations.length != 0) {
                                    <div *ngFor="let education of currentTalent.educations; let isLast = last">
                                        <h5>
                                            {{ education.diploma }} {{ 'Talent.PreviewModal.In' | translate }} {{
                                            education.domain }}
                                        </h5>
                                        <div class="mb-2">
                                            <strong>
                                                {{ 'Talent.PreviewModal.Institution' | translate }}
                                            </strong>
                                            {{ education.institution }}
                                        </div>
                                        <div class="mb-2">
                                            <i class="fa-regular fa-clock me-2"></i>
                                            {{ getEducationDuration(education) }}
                                        </div>
                                        @if(!isLast) {
                                        <hr>
                                        }
                                    </div>
                                    }
                                    @else {
                                    {{ 'Talent.PreviewModal.NoEducations' | translate }}
                                    }
                                </ng-template>
                            </ng-container>
                            <ng-container ngbNavItem="resumes">
                                <a ngbNavLink>
                                    <i class="fa-solid fa-file me-2"></i>
                                    {{ 'Talent.Profile.Resumes' | translate }}
                                </a>
                                <ng-template ngbNavContent>
                                    @if(resumeUrl) {
                                        <iframe [src]="resumeUrl" width="100%" height="800px">
                                        </iframe>
                                    } @else {
                                        <p>
                                            {{ 'Talent.PreviewModal.NoResumeAvailable' | translate }}
                                        </p>
                                    }
                                </ng-template>
                            </ng-container>
                        </nav>
                        <div [ngbNavOutlet]="nav" class="mt-2"></div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

